---
title: "CS598 - Project 3"
author: "Xiaoming Ji"
output: pdf_document
---
# Computer System

## Hardware
- Dell Precision Tower 5810
- CPU: Intel Xeon E5-1607 @ 3.10GHz
- Memory: 32GB

## Software
- OS: Windows 10 Professional 64bit
- R: 3.5.1
- R Packages:

```{r, eval=FALSE, include=FALSE}
data.all = read.csv("loan_stat542.csv")
test.id.all = read.csv("Project3_test_id.csv")

for (i in 1:(dim(test.id.all)[2])){
  
  train.data = data.all[!data.all$id %in% test.id.all[,i],]
  write.csv(train.data, file=paste("train", i, ".csv", sep=""), row.names = FALSE)
  test.data = data.all[data.all$id %in% test.id.all[,i],]
  
  label.data = test.data[,c("id", "loan_status")]
  colnames(label.data)[2] = 'y'
  label.data$y[label.data$y == "Charged Off"] = "Default"
  label.data$y = as.numeric(label.data$y)
  label.data$y[label.data$y == 3] = 0
  label.data$y[label.data$y == 2] = 1
  write.csv(label.data, file=paste("label", i, ".csv", sep=""), row.names = FALSE)
  
  test.data = test.data[, c("loan_status") != names(test.data)]
  write.csv(test.data, file=paste("test", i, ".csv", sep=""), row.names = FALSE)
}
```

```{r, warning=FALSE}
#########################################################################
# Test code begins

start.time = Sys.time()

LOGLOSS = matrix(0, 3, 3)
rownames(LOGLOSS) = c("Test1", "Test2", "Test3")
TEST_NUM = 0

for (i in 1:3){
  TEST_NUM = i
  TRAIN_FILE_NAME = paste("train",i, ".csv", sep = "")
  TEST_FILE_NAME = paste("test",i, ".csv", sep = "")
  LABEL_FILE_NAME = paste("label",i, ".csv", sep = "")
  source('mymain.R')
}
end.time = Sys.time()
run.time = as.numeric(difftime(end.time, start.time, units = 'secs'))

print(LOGLOSS)
cat("\nComputation time:", ceiling(run.time), "Seconds")
```

```{r}
# # submission files
# allFiles = list.files()
# subFiles = grep('mysubmission', allFiles, value = TRUE, 
#                 ignore.case = TRUE)
# 
# # calculate the test error on the test set
# test = read.csv('test.csv')
# 
# label = read.csv('label.csv', sep = ',')
# err = rep(NA, length(subFiles))
# for (met in 1:length(subFiles)){
# 
#     prediction = read.csv(subFiles[met], sep = ',')
#     yp = merge(prediction, label, by = 'id', all.y = TRUE)
#     err[met] = with(yp, logLoss(y, prob))
#     
# }
# 
# #########################################################################
# write.table(err, file = 'proj_3.csv', sep = ',', row.names = FALSE,
#             col.names = FALSE)
# write.table(run.time, file = 'proj_3.csv', sep = ',', 
#             row.names = FALSE, col.names = FALSE, append = TRUE)
```

